<!DOCTYPE html>
<html lang="en">
<head>
  <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
  <script src=>msg.text = "The recommended cooling method is {{ method.replace('_', ' ') }} in {{ location }} data center.";
</script>
  <meta charset="UTF-8" />
  <title>Data Center Cooling Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
</head>
<body class="bg-gray-100 text-gray-800 font-sans">
  <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<div class="mt-6 bg-green-100 text-green-800 text-center p-3 rounded shadow-md">
  ♻️ <strong>Sustainability Score:</strong> {{ score }}/100
</div>

  <!-- Navbar -->
   <nav class="bg-white shadow p-4 flex justify-between items-center sticky top-0 z-50">
    <h1 class="text-2xl font-bold">Sustainability Dashboard</h1>
    <div class="space-x-2">
      <button onclick="showSection('prediction')" class="btn-nav">Prediction</button>
      <button onclick="showSection('location')" class="btn-nav">Location</button>
      <button onclick="showSection('tips')" class="btn-nav">AI Tips</button>
      <button onclick="showSection('feedback')" class="btn-nav">Feedback</button>
      <button onclick="showSection('history')" class="btn-nav">History</button>
    </div>
  </nav>

  <main class="p-6 space-y-6">

    <!-- ✅ Section: Prediction -->
    <section id="prediction" class="section">
      <div class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-semibold mb-4">🌡️ Prediction Result</h2>
        <p><strong>Cooling Method:</strong> {{ cooling_method }}</p>
        <p><strong>Alert Level:</strong> 
           {% if alert == "High" %}
        <span class="text-red-600 font-bold">🔴 HIGH</span>
           {% elif alert == "Moderate" %}
        <span class="text-yellow-600 font-bold">🟠 MODERATE</span>
           {% else %}
        <span class="text-green-600 font-bold">🟢 STABLE</span>
           {% endif %}
        </p>

        <p><strong>Estimated Water Usage:</strong> {{ water_usage }} L/hour</p>
        <button class="mt-4 bg-green-500 text-white px-4 py-2 rounded" onclick="speakResult()">🔊 Voice Alert</button>
        <button class="mt-4 bg-blue-500 text-white px-4 py-2 rounded" onclick="downloadPDF()">📄 Download Report</button>
      </div>
    </section>

    <!-- ✅ Section: Location Info -->
    <section id="location" class="section hidden">
      <div class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-semibold mb-4">📍 Location Information</h2>
        <select id="locationSelect" class="mb-4 p-2 border" onchange="fetchLocationDetails(this.value)">
          <option value="Bangalore">Bangalore</option>
          <option value="Hyderabad">Hyderabad</option>
          <option value="Mumbai">Mumbai</option>
        </select>
        <div id="locationDetails">
          <!-- Dynamic location info will load here -->
          <p><strong>Data Center Head:</strong> <span id="ceo">N/A</span></p>
          <p><strong>Phone:</strong> <span id="phone">N/A</span></p>
          <p><strong>Working Hours:</strong> <span id="hours">N/A</span></p>
          <p><strong>Water Usage:</strong> <span id="waterLoc">N/A</span></p>
        </div>
      </div>
    </section>

    <!-- ✅ Section: AI Tips -->
    <section id="tips" class="section hidden">
      <div class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-semibold mb-4">💡 AI Tip</h2>
        <p>{{ ai_tip }}</p>
      </div>
    </section>

    <!-- ✅ Section: Feedback -->
    <section id="feedback" class="section hidden">
      <div class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-semibold mb-4">📝 User Feedback</h2>
        <form method="POST" action="/submit-feedback" class="space-y-4">
          <textarea name="feedback" rows="4" required class="w-full border p-2 rounded" placeholder="Enter your feedback..."></textarea>
          <select name="rating" class="w-full border p-2 rounded">
            <option value="1">⭐</option>
            <option value="2">⭐⭐</option>
            <option value="3">⭐⭐⭐</option>
            <option value="4">⭐⭐⭐⭐</option>
            <option value="5">⭐⭐⭐⭐⭐</option>
          </select>
          <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">Submit</button>
        </form>
        <div class="p-3 mt-2 bg-green-200 text-green-800 rounded shadow">
            ✅ Thank you for your feedback!
      </div>
    </section>

    <!-- ✅ Section: History -->
    <section id="history" class="section hidden">
      <div class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-semibold mb-4">📂 Prediction History</h2>
        {% if history %}
          <table class="w-full table-auto border">
            <thead><tr><th>Date</th><th>Method</th><th>Alert</th><th>Usage</th></tr></thead>
            <tbody>
              {% for h in history %}
              <tr>
                <td>{{ h.date }}</td>
                <td>{{ h.method }}</td>
                <td>{{ h.alert }}</td>
                <td>{{ h.usage }} L/h</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p>No past predictions found.</p>
        {% endif %}
      </div>
    </section>
    <!-- ✅ Section: Live Graphs -->
<section id="graph" class="section bg-white p-6 rounded shadow">
  <h2 class="text-xl font-semibold mb-4">📊 Live Environmental Trends</h2>
  <canvas id="trendChart" height="100"></canvas>
</section>

  </main>

  <style>
    .btn-nav {
      padding: 8px 12px;
      background-color: #f3f4f6;
      border-radius: 6px;
      font-weight: 500;
    }
    .btn-nav:hover {
      background-color: #e5e7eb;
    }
  </style>

</body>
</html>
<head>
  <meta charset="UTF-8" />
  <title>SmartCool.AI Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    window.onload = function () {
      const msg = new SpeechSynthesisUtterance();
      msg.text = "The recommended cooling method is {{ method.replace('_', ' ') }} in {{ location }} data center.";
      window.speechSynthesis.speak(msg);
    };
  </script>
</head>
<body class="bg-gray-100 min-h-screen text-gray-900">
  <header class="bg-blue-800 text-white p-5 shadow-md">
    <h1 class="text-3xl font-bold text-center">🌿 SmartCool.AI - Sustainable Cooling Dashboard</h1>
  </header>

  <main class="p-6 grid grid-cols-1 lg:grid-cols-3 gap-6 max-w-7xl mx-auto mt-6">

    <!-- Cooling Method -->
    <section class="col-span-1 lg:col-span-2 bg-white p-6 rounded-2xl shadow-md">
      <h2 class="text-2xl font-bold text-blue-700 mb-4">Recommended Cooling Method</h2>
      <div class="text-4xl font-semibold text-center py-6 bg-gradient-to-r from-blue-600 to-green-500 text-white rounded-xl">
        {{ method.replace('_', ' ') }}
      </div>
      <div class="mt-4 text-lg space-y-2">
        <p>📍 Location: <strong>{{ location }}</strong></p>
        <p>🌡️ Temperature: <strong>{{ temp }}°C</strong></p>
        <p>💧 Humidity: <strong>{{ humidity }}%</strong></p>
        <p>🖥️ Server Load: <strong>{{ load }}%</strong></p>
      </div>
    </section>

    <!-- Alert Level -->
    <section class="bg-white p-6 rounded-2xl shadow-md">
      <h2 class="text-xl font-bold text-red-600 mb-4">⚠️ Environmental Alert</h2>
      {% if temp > 45 or humidity > 70 %}
        <div class="bg-red-100 text-red-800 p-4 rounded-lg">
          <p><strong>Danger:</strong> Immediate action recommended due to extreme conditions.</p>
        </div>
      {% elif temp > 35 or humidity > 60 %}
        <div class="bg-yellow-100 text-yellow-800 p-4 rounded-lg">
          <p><strong>Moderate Risk:</strong> Monitor closely and optimize cooling.</p>
        </div>
      {% else %}
        <div class="bg-green-100 text-green-800 p-4 rounded-lg">
          <p><strong>Stable:</strong> Conditions are optimal.</p>
        </div>
      {% endif %}
    </section>

    <!-- Water Usage Stats -->
    <section class="bg-white p-6 rounded-2xl shadow-md">
      <h2 class="text-xl font-bold text-indigo-700 mb-4">💧 Water Consumption</h2>
      <p>Location: <strong>{{ location }}</strong></p>
      <p>
        Estimated Monthly Water Usage: 
        <strong>
          {% if location == "Bangalore" %}
            22,000 Litres
          {% elif location == "Hyderabad" %}
            18,000 Litres
          {% elif location == "Mumbai" %}
            25,000 Litres
          {% else %}
            20,000 Litres
          {% endif %}
        </strong>
      </p>
    </section>

    <!-- AI Tips -->
    <section class="bg-white p-6 rounded-2xl shadow-md">
      <h2 class="text-xl font-bold text-green-700 mb-4">🤖 AI Optimization Tips</h2>
      <ul class="list-disc ml-5 space-y-2 text-gray-700">
        <li>Use predictive cooling based on real-time IoT sensor data.</li>
        <li>Schedule heavy compute loads during cooler hours.</li>
        <li>Use AI to balance load between servers to reduce overheating.</li>
      </ul>
    </section>
    <table class="w-full table-auto border divide-y divide-gray-200">
  <thead class="bg-blue-100">
    <tr class="text-left">
      <th class="p-2">📅 Date</th>
      <th class="p-2">❄️ Method</th>
      <th class="p-2">⚠️ Alert</th>
      <th class="p-2">💧 Usage</th>
    </tr>
  </thead>
  <tbody>
    {% for h in history %}
    <tr class="hover:bg-gray-100">
      <td class="p-2">{{ h.date }}</td>
      <td class="p-2">{{ h.method }}</td>
      <td class="p-2">
        {% if h.alert == 'High' %}<span class="text-red-600">High</span>{% elif h.alert == 'Moderate' %}<span class="text-yellow-600">Moderate</span>{% else %}<span class="text-green-600">Stable</span>{% endif %}
      </td>
      <td class="p-2">{{ h.usage }} L/h</td>
    </tr>
    {% endfor %}
     </tbody>
     </table>
    <!-- Feedback & Contact -->
    <section class="bg-white p-6 rounded-2xl shadow-md lg:col-span-2">
      <h2 class="text-xl font-bold text-blue-800 mb-4">📞 Contact & Feedback</h2>
      <div class="space-y-2 text-gray-800">
        <p>🏢 Location Manager: 
          {% if location == "Bangalore" %}
            Ravi Kumar (9 AM - 5 PM)
          {% elif location == "Hyderabad" %}
            Anusha Reddy (10 AM - 6 PM)
          {% elif location == "Mumbai" %}
            Suresh Patil (8 AM - 4 PM)
          {% else %}
            Asha Nair (General)
          {% endif %}
        </p>
        <p>📱 Emergency Contact: <strong>+91-9876543210</strong></p>
        <form action="/feedback" method="post" class="mt-4">
          <textarea name="feedback" rows="3" placeholder="Your feedback..." class="w-full p-3 border rounded"></textarea>
          <button type="submit" class="mt-2 bg-blue-700 text-white px-6 py-2 rounded hover:bg-blue-800">Submit Feedback</button>
        </form>
      </div>
    </section>
  </main>

  <footer class="text-center py-4 text-sm text-gray-500 mt-6">
    &copy; 2025 SmartCool.AI | Promoting Sustainable Data Centers
  </footer>
</body>
</html>
